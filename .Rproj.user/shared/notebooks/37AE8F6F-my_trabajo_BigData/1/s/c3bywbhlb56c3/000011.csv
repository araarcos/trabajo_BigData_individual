"0","#- segundo gr√°fico"
"0",""
"0","recaudacion <- df_movies %>%"
"0","  select(movie, `worldwide gross ($m)`) %>%"
"0","  filter(!is.na(`worldwide gross ($m)`)) %>%"
"0","  mutate("
"0","    id = row_number(),"
"0","    value = `worldwide gross ($m)`,"
"0","    individual = movie)"
"0",""
"0","number_of_bar <- nrow(recaudacion)"
"0",""
"0","angle <- 90 - 360 * (recaudacion$id - 0.5) / number_of_bar"
"0",""
"0","recaudacion$hjust <- ifelse(angle < -90, 1, 0)"
"0","recaudacion$angle <- ifelse(angle < -90, angle + 180, angle)"
"0",""
"0",""
"0","p <- ggplot(recaudacion, aes(x = as.factor(id), y = value)) +"
"0","    geom_bar(stat = ""identity"", fill = alpha(""#2B5C8A"", 0.9)) +"
"0","    ylim(-max(recaudacion$value) * 0.25, max(recaudacion$value) * 1.1) +"
"0","    theme_minimal(base_family = ""mono"") +"
"0","    theme("
"0","    axis.text = element_blank(),"
"0","    axis.title = element_blank(),"
"0","    panel.grid = element_blank(),"
"0","    plot.margin = unit(rep(1, 4), ""cm"")) +"
"0","   coord_polar(start = 0) +"
"0","  geom_text("
"0","    data = recaudacion,"
"0","    aes("
"0","      x = id,"
"0","      y = value + max(recaudacion$value) * 0.05,"
"0","      label = individual,"
"0","      hjust = hjust),"
"0","    angle = recaudacion$angle,"
"0","    inherit.aes = FALSE,"
"0","    size = 3,"
"0","    alpha = 0.7)"
"0",""
"0","p"
